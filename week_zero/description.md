## Сервисы
- Таск-трекер
- Аккаунтинг
- Аналитика

## Описание коммуникаций
### Сервисы и базы данных (Синхронная коммуникация):
Тип: Синхронный.
Данные:
- От Таск-трекера к БД: Создание задач, обновление статуса задач, запрос задач, назначенных на пользователя.
- От Аккаунтинга к БД: Запись финансовых транзакций, запрос баланса и истории операций по счетам пользователей.
- От Аналитики к БД: Запросы для агрегации данных о выполненных задачах, финансовых показателях.
### Сервисы и Kafka (Асинхронная коммуникация):
Тип: Асинхронный.
Данные:
- Таск-трекер → Kafka:
Тема: TaskCreated: ID задачи, описание, назначенный пользователь, цена задачи.
Тема: TaskCompleted: ID задачи, ID пользователя, фактическая цена выполнения.
- Аккаунтинг → Kafka:
Тема: TransactionCreated: ID транзакции, тип операции (например, начисление за выполнение задачи, списание при назначении задачи), сумма, ID пользователя.
- Kafka → Аналитика:
Тема: TaskCompleted: Аналитика подписывается на сообщения о выполненных задачах для расчета статистики и определения самой дорогой задачи.
Тема: TransactionCreated: Аналитика использует данные о транзакциях для расчета финансовых показателей, например, среднедневной доход.
### Коммуникации между сервисами через Kafka:
- Таск-трекер публикует сообщения о создании и завершении задач в соответствующие темы Kafka, которые могут быть использованы другими сервисами для асинхронного реагирования на эти события.
- Аккаунтинг публикует сообщения о создании транзакций, что позволяет Аналитике асинхронно получать данные для анализа финансовых показателей.
### Асинхронное обновление данных:
После обработки сообщений из Kafka, сервисы могут асинхронно обновлять данные в своих БД, не блокируя друг друга и обеспечивая высокую доступность и отказоустойчивость системы.
Эта модель коммуникации обеспечивает гибкость и масштабируемость системы, позволяя сервисам обрабатывать данные независимо и реагировать на изменения в реальном времени без необходимости жесткой синхронизации.

## Возможные проблемы с данными и варианты их решения

### Проблемы с сетью
- Retry Policies (Политики повторных попыток): Автоматически повторять попытки отправки сообщений или выполнения запросов после кратковременных сетевых сбоев.
- Circuit Breaker Pattern: Предотвращает попытки выполнения операции, которая, вероятно, потерпит неудачу, из-за предыдущих ошибок, помогая системе быстрее восстановиться.
### Сбои баз данных
- Master-Slave Replication (Репликация Master-Slave): Необходимо реплицированные базы данных для обеспечения высокой доступности. В случае сбоя основной (master) базы данных, можно быстро переключиться на резервную (slave).
- Backup and Restore Procedures (Процедуры резервного копирования и восстановления): Регулярно создавать резервные копии данных для возможности их восстановления после сбоя.
### Проблемы с Kafka или другими компонентами межсервисного взаимодействия
- Message Durability (Долговечность сообщений): Настроить Kafka для сохранения сообщений на диск, чтобы предотвратить их потерю при сбое.
- Consumer Offsets Management (Управление смещениями потребителей): Настроить и управлять смещениями потребителей, чтобы после восстановления системы можно было обработать необработанные сообщения.
### Общие стратегии обеспечения отказоустойчивости и восстановления
- Distributed Caching (Распределенное кэширование): Использовать распределенные кэши для снижения зависимости от базы данных и уменьшения влияния сетевых задержек.
- Monitoring and Alerting (Мониторинг и оповещение): Настроить системы мониторинга для наблюдения за производительностью и доступностью всех компонентов системы. Автоматизированные оповещения помогут оперативно реагировать на проблемы.
- Disaster Recovery Plan (План восстановления после сбоев): Разработать и регулярно обновлять план действий на случай серьезных сбоев, включая инструкции по восстановлению системы и данных.
### Тестирование отказоустойчивости
- Chaos Engineering (Инженерия хаоса): Регулярно проводить тесты на устойчивость к сбоям, имитируя различные типы отказов (выход из строя сети, баз данных, потерю данных и т.д.), чтобы проверить способность системы восстанавливаться.
